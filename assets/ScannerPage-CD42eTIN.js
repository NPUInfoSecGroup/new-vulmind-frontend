import{d as $,u as T,p as x,c as D,r as m,q as C,b as g,e as s,m as N,t as y,s as E,g as l,h as d,w as _,l as P,j as w,_ as B,o as F,v as G}from"./index-Bw9o5Id3.js";import{M,e as A}from"./MessageView-jXIKnI8p.js";import{_ as R}from"./TerminalView.vue_vue_type_style_index_0_lang-8-ZFFB0N.js";import"./index-Dq7h7Pqt.js";const j={class:"header-section"},q={class:"header-content"},U={key:0},z={class:"id"},H={class:"back-button"},J=$({__name:"TaskInfoView",setup(b){const f=T(),a=x().params.taskID,t=D(()=>f.getById(a)),c=m(!1);async function u(){await f.fetchTasks()}u(),C(t,n=>{n?(console.log("当前任务信息:",n),c.value=!0,p()):c.value=!1},{immediate:!0});function p(){console.log("执行后续逻辑")}return(n,i)=>{const e=d("el-button");return w(),g("div",j,[s("div",q,[c.value?(w(),g("h1",U,y(t.value.name),1)):N("",!0),s("p",z,y(E(a)),1)]),s("div",H,[l(e,{type:"primary",onClick:i[0]||(i[0]=o=>n.$router.back())},{default:_(()=>i[1]||(i[1]=[P("返回")])),_:1,__:[1]})])])}}}),K=B(J,[["__scopeId","data-v-8bc56560"]]),L={class:"common-layout"},O={class:"message-card"},Q={class:"header-title"},W={class:"target"},X={class:"command"},Y={class:"action"},Z={class:"terminal"},tt=$({__name:"EnvironmentInfoView",setup(b){const r=x().params.taskID,a=T(),t=m(a.safeGetById(r)),c=m(null),u=m(!1),p=()=>{var v,h,k;const e=((v=t.value)==null?void 0:v.status)==="completed"||((h=t.value)==null?void 0:h.status)==="failed";(k=t.value)!=null&&k.id&&!u.value&&!e&&(u.value=!0,c.value=window.setInterval(async()=>{var I,V;try{await a.fetchTasks();const S=a.safeGetById(r);t.value=S,(((I=t.value)==null?void 0:I.status)==="completed"||((V=t.value)==null?void 0:V.status)==="failed")&&n()}catch(S){console.error("轮询任务状态失败:",S),n()}},5e3))},n=()=>{c.value!==null&&(clearInterval(c.value),c.value=null),u.value=!1};async function i(){var e;if((e=t.value)!=null&&e.id)try{await a.startTask(r),A.emit("startAgent"),p()}catch(o){console.error("启动任务失败:",o)}}return F(()=>{a.fetchTasks().then(()=>{t.value=a.safeGetById(r),p()})}),G(()=>{n()}),C(()=>a.getById(r),e=>{e&&(t.value=e,(e.status==="completed"||e.status==="failed")&&n())},{immediate:!0}),(e,o)=>{const v=d("el-button"),h=d("el-aside"),k=d("el-main"),I=d("el-container");return w(),g("div",L,[l(I,null,{default:_(()=>[l(h,{width:"50%",class:"aside"},{default:_(()=>[o[1]||(o[1]=s("h2",null,"环境信息",-1)),s("div",O,[s("div",Q,[s("span",W,y(t.value&&t.value.target),1),s("span",X,y(t.value&&t.value.command),1)]),s("div",Y,[l(v,{type:"primary",onClick:i},{default:_(()=>o[0]||(o[0]=[P(" 执行任务 ")])),_:1,__:[0]})])]),s("div",Z,[l(R)])]),_:1,__:[1]}),l(k,null,{default:_(()=>[o[2]||(o[2]=s("h2",null,"扫描过程",-1)),l(M)]),_:1,__:[2]})]),_:1})])}}}),et=B(tt,[["__scopeId","data-v-3009aec6"]]),st={class:"report-template-view"},at=$({__name:"ScannerPage",setup(b){return m("first"),(f,r)=>(w(),g("div",st,[l(K),l(et)]))}}),it=B(at,[["__scopeId","data-v-1a0f5315"]]);export{it as default};
