import{d as b,u as S,p as V,c as E,r as m,q as x,b as h,e as o,m as C,t as y,s as M,g as c,h as i,w as _,l as P,j as p,_ as $,o as R,v as j,f as q}from"./index-CQN84zgM.js";import w from"./MessageView-D_WxZALB.js";const A={class:"header-section"},U={class:"header-content"},z={key:0},F={class:"id"},G={class:"back-button"},H=b({__name:"TaskInfoView",setup(B){const f=S(),n=V().params.taskID,t=E(()=>f.getById(n)),l=m(!1);async function d(){await f.fetchTasks()}d(),x(t,a=>{a?(console.log("当前任务信息:",a),l.value=!0,v()):l.value=!1},{immediate:!0});function v(){console.log("执行后续逻辑")}return(a,u)=>{const e=i("el-button");return p(),h("div",A,[o("div",U,[l.value?(p(),h("h1",z,y(t.value.name),1)):C("",!0),o("p",F,y(M(n)),1)]),o("div",G,[c(e,{type:"primary",onClick:u[0]||(u[0]=s=>a.$router.back())},{default:_(()=>u[1]||(u[1]=[P("返回")])),_:1,__:[1]})])])}}}),J=$(H,[["__scopeId","data-v-8bc56560"]]),K={class:"common-layout"},L={class:"message-card"},O={class:"header-title"},Q={class:"target"},W={class:"command"},X={class:"action"},Y=b({__name:"EnvironmentInfoView",setup(B){const r=V().params.taskID,n=S(),t=m(n.getById(r)),l=m(null),d=m(!1),v=()=>{var e,s;d.value||((e=t.value)==null?void 0:e.status)==="completed"||((s=t.value)==null?void 0:s.status)==="failed"||(d.value=!0,l.value=setInterval(async()=>{var g,I;try{await n.fetchTasks(),t.value=n.getById(r),(((g=t.value)==null?void 0:g.status)==="completed"||((I=t.value)==null?void 0:I.status)==="failed")&&(console.log(`任务 ${r} 已结束，状态: ${t.value.status}`),a())}catch(k){console.error("轮询任务状态失败:",k),a()}},5e3))},a=()=>{l.value&&(clearInterval(l.value),l.value=null),d.value=!1};function u(){n.startTask(r),v()}return R(()=>{v()}),j(()=>{a()}),x(()=>n.getById(r),e=>{t.value=e,((e==null?void 0:e.status)==="completed"||(e==null?void 0:e.status)==="failed")&&a()},{immediate:!0}),(e,s)=>{const g=i("el-button"),I=i("el-scrollbar"),k=i("el-aside"),D=i("el-main"),N=i("el-container");return p(),h("div",K,[c(N,null,{default:_(()=>[c(k,{width:"50%",class:"aside"},{default:_(()=>[s[2]||(s[2]=o("h2",null,"环境信息",-1)),o("div",L,[o("div",O,[o("span",Q,y(t.value.target),1),o("span",W,y(t.value.command),1)]),o("div",X,[t.value.status=="pending"?(p(),q(g,{key:0,type:"primary",onClick:u},{default:_(()=>s[0]||(s[0]=[P(" 执行任务 ")])),_:1,__:[0]})):C("",!0)])]),c(I,null,{default:_(()=>s[1]||(s[1]=[o("div",{class:"terminal"},null,-1)])),_:1,__:[1]})]),_:1,__:[2]}),c(D,null,{default:_(()=>[s[3]||(s[3]=o("h2",null,"扫描过程",-1)),c(w)]),_:1,__:[3]})]),_:1})])}}}),Z=$(Y,[["__scopeId","data-v-bc84cb35"]]),T={class:"report-template-view"},tt=b({__name:"ScannerPage",setup(B){return m("first"),(f,r)=>(p(),h("div",T,[c(J),c(Z)]))}}),ot=$(tt,[["__scopeId","data-v-1a0f5315"]]);export{ot as default};
