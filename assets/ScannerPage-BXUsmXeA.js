import{d as B,u as T,p as x,c as N,r as f,q as C,b as w,e as s,m as P,t as S,s as E,g as c,h as _,w as m,l as D,j as p,_ as b,o as F,v as G,f as M}from"./index-DCDRhhL_.js";import R from"./MessageView-Cha90XAH.js";import{_ as j}from"./TerminalView.vue_vue_type_style_index_0_lang-n4kx0dih.js";const q={class:"header-section"},A={class:"header-content"},U={key:0},z={class:"id"},H={class:"back-button"},J=B({__name:"TaskInfoView",setup(V){const v=T(),a=x().params.taskID,t=N(()=>v.getById(a)),l=f(!1);async function u(){await v.fetchTasks()}u(),C(t,n=>{n?(console.log("当前任务信息:",n),l.value=!0,h()):l.value=!1},{immediate:!0});function h(){console.log("执行后续逻辑")}return(n,i)=>{const e=_("el-button");return p(),w("div",q,[s("div",A,[l.value?(p(),w("h1",U,S(t.value.name),1)):P("",!0),s("p",z,S(E(a)),1)]),s("div",H,[c(e,{type:"primary",onClick:i[0]||(i[0]=o=>n.$router.back())},{default:m(()=>i[1]||(i[1]=[D("返回")])),_:1,__:[1]})])])}}}),K=b(J,[["__scopeId","data-v-8bc56560"]]),L={class:"common-layout"},O={class:"message-card"},Q={class:"header-title"},W={class:"target"},X={class:"command"},Y={class:"action"},Z={class:"terminal"},tt=B({__name:"EnvironmentInfoView",setup(V){const r=x().params.taskID,a=T(),t=f(a.safeGetById(r)),l=f(null),u=f(!1),h=()=>{var k,I,y;const e=((k=t.value)==null?void 0:k.status)==="completed"||((I=t.value)==null?void 0:I.status)==="failed";(y=t.value)!=null&&y.id&&!u.value&&!e&&(u.value=!0,l.value=window.setInterval(async()=>{var g,d;try{await a.fetchTasks();const $=a.safeGetById(r);t.value=$,(((g=t.value)==null?void 0:g.status)==="completed"||((d=t.value)==null?void 0:d.status)==="failed")&&n()}catch($){console.error("轮询任务状态失败:",$),n()}},5e3))},n=()=>{l.value!==null&&(clearInterval(l.value),l.value=null),u.value=!1};async function i(){var e;if((e=t.value)!=null&&e.id)try{await a.startTask(r),h()}catch(o){console.error("启动任务失败:",o)}}return F(()=>{a.fetchTasks().then(()=>{t.value=a.safeGetById(r),h()})}),G(()=>{n()}),C(()=>a.getById(r),e=>{e&&(t.value=e,(e.status==="completed"||e.status==="failed")&&n())},{immediate:!0}),(e,o)=>{const k=_("el-button"),I=_("el-aside"),y=_("el-main"),g=_("el-container");return p(),w("div",L,[c(g,null,{default:m(()=>[c(I,{width:"50%",class:"aside"},{default:m(()=>{var d;return[o[1]||(o[1]=s("h2",null,"环境信息",-1)),s("div",O,[s("div",Q,[s("span",W,S(t.value&&t.value.target),1),s("span",X,S(t.value&&t.value.command),1)]),s("div",Y,[((d=t.value)==null?void 0:d.status)=="pending"?(p(),M(k,{key:0,type:"primary",onClick:i},{default:m(()=>o[0]||(o[0]=[D(" 执行任务 ")])),_:1,__:[0]})):P("",!0)])]),s("div",Z,[c(j)])]}),_:1,__:[1]}),c(y,null,{default:m(()=>[o[2]||(o[2]=s("h2",null,"扫描过程",-1)),c(R)]),_:1,__:[2]})]),_:1})])}}}),et=b(tt,[["__scopeId","data-v-0394668e"]]),st={class:"report-template-view"},at=B({__name:"ScannerPage",setup(V){return f("first"),(v,r)=>(p(),w("div",st,[c(K),c(et)]))}}),rt=b(at,[["__scopeId","data-v-1a0f5315"]]);export{rt as default};
