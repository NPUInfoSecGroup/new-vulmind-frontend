const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-B_uDclz2.js","assets/index-C42FKyLi.css"])))=>i.map(i=>d[i]);
import{_ as I,r as y,o as A,a as G,c as J,b as m,d as e,e as k,f as a,w as n,g as u,h as x,E as j,u as W,i as c,F as U,j as D,k as p,t as o,n as V,l as v}from"./index-B_uDclz2.js";const K={class:"scan-history-view"},Q={class:"filter-card"},X={class:"filter-item"},Z={class:"filter-item"},ee={class:"filter-item"},te={class:"scanner-header"},se={class:"name"},le={class:"date-info"},ae={class:"date"},ne={class:"card-body"},oe={class:"target-info"},ie={class:"target"},re={class:"vuln-summary"},ce={key:0,class:"vuln-item critical"},de={class:"vuln-count"},ue={key:1,class:"vuln-item high"},me={class:"vuln-count"},_e={key:2,class:"vuln-item medium"},ve={class:"vuln-count"},pe={key:3,class:"vuln-item low"},fe={class:"vuln-count"},ye={class:"card-footer action-buttons"},ge={key:0,class:"tech-detail-container"},be={class:"vulnerability-section"},he={class:"section-title"},ke={class:"vuln-count"},Ve={class:"vuln-list"},Se={class:"vuln-header"},Re={class:"vuln-title"},we={class:"vuln-id"},Ce={class:"vuln-name"},Le={class:"vuln-actions"},xe={class:"vuln-content"},je={class:"vuln-description"},Ue={class:"vuln-info-grid"},De={class:"info-item"},Ee={class:"info-item"},Oe={key:0,class:"vuln-location"},Te={key:1,class:"vuln-request"},$e={class:"dialog-footer"},Be={__name:"ScanHistory",setup(He){const E=W(),S=y([]),R=y(!0),O=async()=>{try{R.value=!0;const l=Object.assign({"/src/scan-details/scan-2023091401.json":()=>x(()=>import("./index-B_uDclz2.js").then(r=>r.G),__vite__mapDeps([0,1])),"/src/scan-details/scan-2023091501.json":()=>x(()=>import("./index-B_uDclz2.js").then(r=>r.H),__vite__mapDeps([0,1]))}),t=await Promise.all(Object.keys(l).map(async r=>{const i=await l[r]();return i.default||i}));S.value=t.filter(Boolean).sort((r,i)=>i.id.localeCompare(r.id))}catch(l){console.error("加载扫描记录失败:",l),j.error("加载扫描记录失败: "+l.message)}finally{R.value=!1}};A(()=>{O()});const d=G({target:"",dateRange:[],status:""}),w=J(()=>S.value.filter(l=>{const t=d.target?l.target.toLowerCase().includes(d.target.toLowerCase()):!0,r=d.dateRange.length===2?l.date>=d.dateRange[0]&&l.date<=d.dateRange[1]:!0,i=d.status?l.status===d.status:!0;return t&&r&&i})),g=y(!1),_=y(null),T=l=>{switch(l){case"critical":return"danger";case"high":return"warning";case"medium":return"primary";case"low":return"success";default:return"info"}},$=l=>{switch(l){case"critical":return"严重";case"high":return"高危";case"medium":return"中危";case"low":return"低危";default:return"未知"}},B=l=>{switch(l){case"critical":return"极高风险";case"high":return"高风险";case"medium":return"中等风险";case"low":return"低风险";default:return"未知风险"}},H=l=>{_.value={...l},E.push("/scan-history/"+l.id)},N=l=>{const t=new Blob([JSON.stringify(l,null,2)],{type:"application/json"}),r=URL.createObjectURL(t),i=document.createElement("a");i.href=r,i.download=`${l.id}.json`,i.click(),URL.revokeObjectURL(r),j.success(`${l.id} 已导出`)};return(l,t)=>{const r=u("el-input"),i=u("el-col"),P=u("el-date-picker"),f=u("el-option"),z=u("el-select"),C=u("el-row"),L=u("el-tag"),b=u("el-button"),F=u("el-card"),M=u("el-empty"),Y=u("el-tooltip"),q=u("el-dialog");return c(),m("div",K,[t[24]||(t[24]=e("div",{class:"header-section"},[e("div",{class:"header-content"},[e("div",{class:"title-container"},[e("h1",null,"扫描历史记录")]),e("p",{class:"subtitle"},"查看和管理扫描历史记录，分析漏洞技术细节")])],-1)),e("div",Q,[a(C,{gutter:20},{default:n(()=>[a(i,{xs:24,sm:12,md:8},{default:n(()=>[e("div",X,[t[6]||(t[6]=e("label",{class:"filter-label"},"扫描目标",-1)),a(r,{modelValue:d.target,"onUpdate:modelValue":t[0]||(t[0]=s=>d.target=s),placeholder:"输入URL或关键词",class:"filter-input"},{prefix:n(()=>t[5]||(t[5]=[e("i",{class:"fas fa-bullseye"},null,-1)])),_:1},8,["modelValue"])])]),_:1}),a(i,{xs:24,sm:12,md:8},{default:n(()=>[e("div",Z,[t[8]||(t[8]=e("label",{class:"filter-label"},"日期范围",-1)),a(P,{modelValue:d.dateRange,"onUpdate:modelValue":t[1]||(t[1]=s=>d.dateRange=s),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"YYYY-MM-DD",class:"filter-date-picker"},{prefix:n(()=>t[7]||(t[7]=[e("i",{class:"fas fa-calendar"},null,-1)])),_:1},8,["modelValue"])])]),_:1}),a(i,{xs:24,sm:12,md:8},{default:n(()=>[e("div",ee,[t[9]||(t[9]=e("label",{class:"filter-label"},"状态",-1)),a(z,{modelValue:d.status,"onUpdate:modelValue":t[2]||(t[2]=s=>d.status=s),placeholder:"选择状态",class:"filter-select"},{default:n(()=>[a(f,{label:"全部",value:""}),a(f,{label:"已完成",value:"completed"}),a(f,{label:"失败",value:"failed"}),a(f,{label:"进行中",value:"scanning"})]),_:1},8,["modelValue"])])]),_:1})]),_:1})]),w.value.length>0?(c(),k(C,{key:0,gutter:20,class:"scan-history-cards",s:""},{default:n(()=>[(c(!0),m(U,null,D(w.value,(s,h)=>(c(),k(i,{key:h,xs:24,sm:12,md:8,lg:6},{default:n(()=>[a(F,{class:"scan-history-card",shadow:"hover"},{default:n(()=>[e("div",te,[e("div",se,[p(o(s.name||`扫描记录 ${h+1}`)+" ",1),a(L,{type:s.type==="web"?"primary":"warning",class:"scan-type-tag",effect:"Plain"},{default:n(()=>[p(o(s.type==="web"?"Web扫描":"二进制扫描"),1)]),_:2},1032,["type"])]),e("div",le,[e("div",ae,o(s.date)+" "+o(s.time),1)])]),e("div",ne,[e("div",oe,[e("i",{class:V(["fas",s.type==="web"?"fa-globe":"fa-file-code"])},null,2),e("span",ie,o(s.target),1)]),e("div",re,[s.vulnSummary.critical>0?(c(),m("div",ce,[t[10]||(t[10]=e("span",{class:"vuln-label"},"严重",-1)),e("span",de,o(s.vulnSummary.critical),1)])):v("",!0),s.vulnSummary.high>0?(c(),m("div",ue,[t[11]||(t[11]=e("span",{class:"vuln-label"},"高危",-1)),e("span",me,o(s.vulnSummary.high),1)])):v("",!0),s.vulnSummary.medium>0?(c(),m("div",_e,[t[12]||(t[12]=e("span",{class:"vuln-label"},"中危",-1)),e("span",ve,o(s.vulnSummary.medium),1)])):v("",!0),s.vulnSummary.low>0?(c(),m("div",pe,[t[13]||(t[13]=e("span",{class:"vuln-label"},"低危",-1)),e("span",fe,o(s.vulnSummary.low),1)])):v("",!0)])]),e("div",ye,[a(b,{type:"primary",onClick:Ne=>H(s),class:"gobutton"},{default:n(()=>t[14]||(t[14]=[e("i",{class:"fas fa-search"},null,-1),p(" 查看详情 ")])),_:2,__:[14]},1032,["onClick"])])]),_:2},1024)]),_:2},1024))),128))]),_:1})):(c(),k(M,{key:1,description:"暂无扫描记录","image-size":"160",class:"empty-placeholder"})),a(q,{modelValue:g.value,"onUpdate:modelValue":t[4]||(t[4]=s=>g.value=s),title:`扫描技术细节 - ${_.value?_.value.target:""}`,width:"85%",top:"5vh","custom-class":"tech-detail-dialog"},{footer:n(()=>[e("div",$e,[a(b,{onClick:t[3]||(t[3]=s=>g.value=!1)},{default:n(()=>t[23]||(t[23]=[p("关闭")])),_:1,__:[23]})])]),default:n(()=>[_.value?(c(),m("div",ge,[e("div",be,[e("h3",he,[t[15]||(t[15]=e("i",{class:"fas fa-bug"},null,-1)),t[16]||(t[16]=p(" 漏洞列表 ")),e("span",ke,"(共 "+o(_.value.vulnerabilities.length)+" 个漏洞)",1)]),e("div",Ve,[(c(!0),m(U,null,D(_.value.vulnerabilities,s=>(c(),m("div",{key:s.id,class:V(["vuln-item",s.severity])},[e("div",Se,[e("div",Re,[e("span",we,o(s.id),1),e("span",Ce,o(s.name),1),a(L,{type:T(s.severity),size:"small",effect:"dark",class:"severity-tag"},{default:n(()=>[p(o($(s.severity)),1)]),_:2},1032,["type"])]),e("div",Le,[a(Y,{effect:"dark",content:"导出详情",placement:"top"},{default:n(()=>[a(b,{circle:"",size:"small",onClick:h=>N(s)},{default:n(()=>t[17]||(t[17]=[e("i",{class:"fas fa-download"},null,-1)])),_:2,__:[17]},1032,["onClick"])]),_:2},1024)])]),e("div",xe,[e("div",je,[t[18]||(t[18]=e("label",null,"详细描述:",-1)),e("p",null,o(s.description),1)]),e("div",Ue,[e("div",De,[t[19]||(t[19]=e("label",null,"风险等级:",-1)),e("span",{class:V("risk-level "+s.severity)},o(B(s.severity)),3)]),e("div",Ee,[t[20]||(t[20]=e("label",null,"发现时间:",-1)),e("span",null,o(_.value.time),1)])]),s.location?(c(),m("div",Oe,[t[21]||(t[21]=e("label",null,"漏洞位置:",-1)),e("pre",null,o(s.location),1)])):v("",!0),s.request?(c(),m("div",Te,[t[22]||(t[22]=e("label",null,"请求示例:",-1)),e("pre",null,o(s.request),1)])):v("",!0)])],2))),128))])])])):v("",!0)]),_:1},8,["modelValue","title"])])}}},ze=I(Be,[["__scopeId","data-v-a7d153c9"]]);export{ze as default};
