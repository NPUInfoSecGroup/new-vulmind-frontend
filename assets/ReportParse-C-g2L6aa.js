import{_ as C,r as u,c as D,q as P,b as r,e,m as L,F as $,k as E,n as f,t as m,H as U,z as j,A as B,l as h,j as l,C as H}from"./index-CQN84zgM.js";import{m as _,p as M}from"./purify.es-CsY-PwS5.js";const O={class:"deepseek-container"},R={class:"chat-panel"},K={class:"messages-container"},N={class:"message-header"},V={key:0,class:"fas fa-user"},z={key:1,class:"fas fa-robot"},q=["innerHTML"],F={key:0,class:"typing-container"},J={class:"input-container"},G=["disabled"],Q=["disabled"],W={key:0,class:"fas fa-spinner fa-spin"},X={key:1,class:"fas fa-paper-plane"},Y={class:"control-panel"},Z={class:"status-container"},ee={__name:"ReportParse",setup(te){const b=t=>{if(!t)return"";_.setOptions({gfm:!0,breaks:!0,highlight:(a,n)=>`<pre><code class="hljs language-${n||"plaintext"}">${k(a)}</code></pre>`});const s=_.parse(t);return M.sanitize(s)},k=t=>t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),y=()=>{H(()=>{const t=document.querySelector(".messages-container");t&&(t.scrollTop=t.scrollHeight)})},o=u([{role:"assistant",content:`你好！我是DeepSeek AI助手。请问有什么我可以帮助您的？

- 我可以回答技术问题
- 帮助解决编程难题
- 解释复杂概念
- 提供学习资源建议`}]),i=u(""),c=u(!1),v=u(!1),d=u("connected"),w=D(()=>({connected:"API连接正常",connecting:"正在连接API...",error:"API连接错误"})[d.value]),g=async()=>{if(!i.value.trim()||c.value)return;const t=i.value;i.value="",o.value.push({role:"user",content:t}),c.value=!0,v.value=!0,d.value="connecting";try{const s=await x(t);o.value.push({role:"assistant",content:s}),d.value="connected"}catch(s){console.error("API请求错误:",s),o.value.push({role:"assistant",content:`抱歉，请求出错: ${s.message}`}),d.value="error"}finally{c.value=!1,v.value=!1}},x=async t=>{const n=await fetch("https://api.deepseek.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer xxx"},body:JSON.stringify({model:"deepseek-chat",messages:[...o.value,{role:"user",content:t}],temperature:.7,max_tokens:2e3,stream:!1})});if(!n.ok)throw new Error(`API请求失败: ${n.status}`);return(await n.json()).choices[0].message.content},S=()=>{if(o.value.length===0)return;let t=`# DeepSeek对话记录

`;o.value.forEach(p=>{const T=p.role==="user"?"**您**:":"**DeepSeek AI**:";t+=`${T}

${p.content}

---

`});const s=new Blob([t],{type:"text/markdown"}),a=URL.createObjectURL(s),n=document.createElement("a");n.href=a,n.download=`deepseek-chat-${new Date().toISOString().slice(0,10)}.md`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(a)},I=()=>{o.value=[{role:"assistant",content:"对话已重置！有什么可以帮您的吗？"}]},A=t=>{t.key==="Enter"&&!t.shiftKey&&(t.preventDefault(),g())};return P(o,()=>{y()},{deep:!0,immediate:!0}),(t,s)=>(l(),r("div",O,[s[4]||(s[4]=e("header",{class:"app-header"},[e("div",{class:"header-content"},[e("h1",{class:"app-title"},"DeepSeek API"),e("p",{class:"app-subtitle"},"AI对话助手")])],-1)),e("div",R,[e("div",K,[(l(!0),r($,null,E(o.value,(a,n)=>(l(),r("div",{key:n,class:f(["message",a.role==="user"?"user-message":"ai-message"])},[e("div",N,[e("div",{class:f(["avatar",a.role==="user"?"user-avatar":"ai-avatar"])},[a.role==="user"?(l(),r("i",V)):(l(),r("i",z))],2),e("strong",null,m(a.role==="user"?"您":"DeepSeek AI"),1)]),e("div",{class:"message-content",innerHTML:b(a.content)},null,8,q)],2))),128)),v.value?(l(),r("div",F,s[1]||(s[1]=[U('<div class="typing-indicator" data-v-5bff8a7c><span class="typing-text" data-v-5bff8a7c>思考中</span><div class="typing-dots" data-v-5bff8a7c><div class="dot" data-v-5bff8a7c></div><div class="dot" data-v-5bff8a7c></div><div class="dot" data-v-5bff8a7c></div></div></div>',1)]))):L("",!0)]),e("div",J,[j(e("textarea",{"onUpdate:modelValue":s[0]||(s[0]=a=>i.value=a),placeholder:"输入您的消息（Shift+Enter换行，Enter发送）...",onKeydown:A,disabled:c.value},null,40,G),[[B,i.value]]),e("button",{class:"submit-btn",onClick:g,disabled:c.value||!i.value.trim()},[c.value?(l(),r("i",W)):(l(),r("i",X)),h(" "+m(c.value?"生成中...":"发送"),1)],8,Q)])]),e("div",Y,[e("div",Z,[e("div",{class:f(["status-indicator",d.value==="connecting"?"connecting":d.value==="error"?"error":""])},null,2),e("span",null,m(w.value),1)]),e("div",{class:"action-buttons"},[e("button",{class:"action-btn download-btn",onClick:S},s[2]||(s[2]=[e("i",{class:"fas fa-download"},null,-1),h(" 保存对话 ")])),e("button",{class:"action-btn clear-btn",onClick:I},s[3]||(s[3]=[e("i",{class:"fas fa-trash-alt"},null,-1),h(" 清空对话 ")]))])])]))}},ne=C(ee,[["__scopeId","data-v-5bff8a7c"]]);export{ne as default};
