const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-CBYW2eJt.js","assets/index-BKfgTys2.css"])))=>i.map(i=>d[i]);
import{_ as J,r as h,o as G,a as W,c as K,b as _,d as e,e as n,w as o,f as d,g as p,E as L,u as Q,h as u,i as m,F as C,j,k as X,t as i,n as V,l as f}from"./index-CBYW2eJt.js";const Z={class:"scan-history-view"},ee={class:"filter-card"},te={class:"filter-section"},se={class:"filter-row"},le={class:"filter-row"},ae={class:"scanner-header"},ne={class:"name"},oe={class:"date-info"},ie={class:"date"},re={class:"card-body"},ce={class:"target-info"},de={class:"target"},ue={class:"vuln-summary"},_e={key:0,class:"vuln-item critical"},me={class:"vuln-count"},ve={key:1,class:"vuln-item high"},pe={class:"vuln-count"},fe={key:2,class:"vuln-item medium"},ye={class:"vuln-count"},ge={key:3,class:"vuln-item low"},he={class:"vuln-count"},be={class:"card-footer action-buttons"},ke={key:0,class:"tech-detail-container"},Ve={class:"vulnerability-section"},Re={class:"section-title"},Ee={class:"vuln-count"},Se={class:"vuln-list"},Le={class:"vuln-header"},Ce={class:"vuln-title"},je={class:"vuln-id"},we={class:"vuln-name"},De={class:"vuln-actions"},Oe={class:"vuln-content"},Te={class:"vuln-description"},Pe={class:"vuln-info-grid"},Ie={class:"info-item"},Ue={class:"info-item"},xe={key:0,class:"vuln-location"},Ae={key:1,class:"vuln-request"},Be={class:"dialog-footer"},He={__name:"ScanHistory",setup($e){const w=Q(),R=h([]),E=h(!0),D=async()=>{try{E.value=!0;const l=Object.assign({"/src/scan-details/scan-2023091401.json":()=>p(()=>import("./index-CBYW2eJt.js").then(a=>a.B),__vite__mapDeps([0,1])),"/src/scan-details/scan-2023091501 copy 2.json":()=>p(()=>import("./index-CBYW2eJt.js").then(a=>a.C),__vite__mapDeps([0,1])),"/src/scan-details/scan-2023091501 copy 3.json":()=>p(()=>import("./index-CBYW2eJt.js").then(a=>a.D),__vite__mapDeps([0,1])),"/src/scan-details/scan-2023091501 copy 4.json":()=>p(()=>import("./index-CBYW2eJt.js").then(a=>a.G),__vite__mapDeps([0,1])),"/src/scan-details/scan-2023091501 copy 5.json":()=>p(()=>import("./index-CBYW2eJt.js").then(a=>a.H),__vite__mapDeps([0,1])),"/src/scan-details/scan-2023091501 copy.json":()=>p(()=>import("./index-CBYW2eJt.js").then(a=>a.I),__vite__mapDeps([0,1])),"/src/scan-details/scan-2023091501.json":()=>p(()=>import("./index-CBYW2eJt.js").then(a=>a.J),__vite__mapDeps([0,1]))}),t=await Promise.all(Object.keys(l).map(async a=>{const c=await l[a]();return c.default||c}));R.value=t.filter(Boolean).sort((a,c)=>c.id.localeCompare(a.id))}catch(l){console.error("加载扫描记录失败:",l),L.error("加载扫描记录失败: "+l.message)}finally{E.value=!1}};G(()=>{D()});const r=W({target:"",dateRange:[],status:""}),O=K(()=>R.value.filter(l=>{const t=r.target?l.target.toLowerCase().includes(r.target.toLowerCase()):!0,a=r.dateRange.length===2?l.date>=r.dateRange[0]&&l.date<=r.dateRange[1]:!0,c=r.status?l.status===r.status:!0;return t&&a&&c})),T=()=>{currentPage.value=1},P=()=>{r.target="",r.dateRange=[],r.status="",currentPage.value=1},b=h(!1),v=h(null),I=l=>{switch(l){case"critical":return"danger";case"high":return"warning";case"medium":return"primary";case"low":return"success";default:return"info"}},U=l=>{switch(l){case"critical":return"严重";case"high":return"高危";case"medium":return"中危";case"low":return"低危";default:return"未知"}},x=l=>{switch(l){case"critical":return"极高风险";case"high":return"高风险";case"medium":return"中等风险";case"low":return"低风险";default:return"未知风险"}},A=l=>{v.value={...l},w.push("/scan-history/"+l.id)},B=l=>{const t=new Blob([JSON.stringify(l,null,2)],{type:"application/json"}),a=URL.createObjectURL(t),c=document.createElement("a");c.href=a,c.download=`${l.id}.json`,c.click(),URL.revokeObjectURL(a),L.success(`${l.id} 已导出`)};return(l,t)=>{const a=d("el-input"),c=d("el-form-item"),H=d("el-date-picker"),g=d("el-option"),$=d("el-select"),y=d("el-button"),F=d("el-form"),S=d("el-tag"),N=d("el-card"),M=d("el-col"),Y=d("el-row"),q=d("el-tooltip"),z=d("el-dialog");return u(),_("div",Z,[t[23]||(t[23]=e("div",{class:"header-section"},[e("div",{class:"header-content"},[e("div",{class:"title-container"},[e("h1",null,"扫描历史记录")]),e("p",{class:"subtitle"},"查看和管理扫描历史记录，分析漏洞技术细节")])],-1)),e("div",ee,[e("div",te,[n(F,{inline:!0,model:r},{default:o(()=>[e("div",se,[n(c,{label:"扫描目标"},{default:o(()=>[n(a,{modelValue:r.target,"onUpdate:modelValue":t[0]||(t[0]=s=>r.target=s),placeholder:"输入URL或关键词",class:"filter-input"},{prefix:o(()=>t[5]||(t[5]=[e("i",{class:"fas fa-bullseye"},null,-1)])),_:1},8,["modelValue"])]),_:1}),n(c,{label:"日期范围"},{default:o(()=>[n(H,{modelValue:r.dateRange,"onUpdate:modelValue":t[1]||(t[1]=s=>r.dateRange=s),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"YYYY-MM-DD",class:"filter-date-picker"},{prefix:o(()=>t[6]||(t[6]=[e("i",{class:"fas fa-calendar"},null,-1)])),_:1},8,["modelValue"])]),_:1})]),e("div",le,[n(c,{label:"状态"},{default:o(()=>[n($,{modelValue:r.status,"onUpdate:modelValue":t[2]||(t[2]=s=>r.status=s),placeholder:"选择状态",class:"filter-select"},{default:o(()=>[n(g,{label:"全部",value:""}),n(g,{label:"已完成",value:"completed"}),n(g,{label:"失败",value:"failed"}),n(g,{label:"进行中",value:"scanning"})]),_:1},8,["modelValue"])]),_:1}),n(c,null,{default:o(()=>[n(y,{type:"primary",onClick:T,class:"filter-button primary"},{default:o(()=>t[7]||(t[7]=[e("i",{class:"fas fa-search"},null,-1),m(" 搜索 ")])),_:1,__:[7]}),n(y,{onClick:P,class:"filter-button secondary"},{default:o(()=>t[8]||(t[8]=[e("i",{class:"fas fa-undo"},null,-1),m(" 重置 ")])),_:1,__:[8]})]),_:1})])]),_:1},8,["model"])])]),n(Y,{gutter:20,class:"scan-history-cards"},{default:o(()=>[(u(!0),_(C,null,j(O.value,(s,k)=>(u(),X(M,{key:k,xs:24,sm:12,md:8,lg:6},{default:o(()=>[n(N,{class:"scan-history-card",shadow:"hover"},{default:o(()=>[e("div",ae,[e("div",ne,[m(i(s.name||`扫描记录 ${k+1}`)+" ",1),n(S,{type:s.type==="web"?"success":"info",class:"scan-type-tag",effect:"dark"},{default:o(()=>[m(i(s.type==="web"?"Web扫描":"二进制扫描"),1)]),_:2},1032,["type"])]),e("div",oe,[e("div",ie,i(s.date)+" "+i(s.time),1)])]),e("div",re,[e("div",ce,[e("i",{class:V(["fas",s.type==="web"?"fa-globe":"fa-file-code"])},null,2),e("span",de,i(s.target),1)]),e("div",ue,[s.vulnSummary.critical>0?(u(),_("div",_e,[t[9]||(t[9]=e("span",{class:"vuln-label"},"严重",-1)),e("span",me,i(s.vulnSummary.critical),1)])):f("",!0),s.vulnSummary.high>0?(u(),_("div",ve,[t[10]||(t[10]=e("span",{class:"vuln-label"},"高危",-1)),e("span",pe,i(s.vulnSummary.high),1)])):f("",!0),s.vulnSummary.medium>0?(u(),_("div",fe,[t[11]||(t[11]=e("span",{class:"vuln-label"},"中危",-1)),e("span",ye,i(s.vulnSummary.medium),1)])):f("",!0),s.vulnSummary.low>0?(u(),_("div",ge,[t[12]||(t[12]=e("span",{class:"vuln-label"},"低危",-1)),e("span",he,i(s.vulnSummary.low),1)])):f("",!0)])]),e("div",be,[n(y,{type:"primary",onClick:Fe=>A(s),class:"gobutton"},{default:o(()=>t[13]||(t[13]=[e("i",{class:"fas fa-search"},null,-1),m(" 查看详情 ")])),_:2,__:[13]},1032,["onClick"])])]),_:2},1024)]),_:2},1024))),128))]),_:1}),n(z,{modelValue:b.value,"onUpdate:modelValue":t[4]||(t[4]=s=>b.value=s),title:`扫描技术细节 - ${v.value?v.value.target:""}`,width:"85%",top:"5vh","custom-class":"tech-detail-dialog"},{footer:o(()=>[e("div",Be,[n(y,{onClick:t[3]||(t[3]=s=>b.value=!1)},{default:o(()=>t[22]||(t[22]=[m("关闭")])),_:1,__:[22]})])]),default:o(()=>[v.value?(u(),_("div",ke,[e("div",Ve,[e("h3",Re,[t[14]||(t[14]=e("i",{class:"fas fa-bug"},null,-1)),t[15]||(t[15]=m(" 漏洞列表 ")),e("span",Ee,"(共 "+i(v.value.vulnerabilities.length)+" 个漏洞)",1)]),e("div",Se,[(u(!0),_(C,null,j(v.value.vulnerabilities,s=>(u(),_("div",{key:s.id,class:V(["vuln-item",s.severity])},[e("div",Le,[e("div",Ce,[e("span",je,i(s.id),1),e("span",we,i(s.name),1),n(S,{type:I(s.severity),size:"small",effect:"dark",class:"severity-tag"},{default:o(()=>[m(i(U(s.severity)),1)]),_:2},1032,["type"])]),e("div",De,[n(q,{effect:"dark",content:"导出详情",placement:"top"},{default:o(()=>[n(y,{circle:"",size:"small",onClick:k=>B(s)},{default:o(()=>t[16]||(t[16]=[e("i",{class:"fas fa-download"},null,-1)])),_:2,__:[16]},1032,["onClick"])]),_:2},1024)])]),e("div",Oe,[e("div",Te,[t[17]||(t[17]=e("label",null,"详细描述:",-1)),e("p",null,i(s.description),1)]),e("div",Pe,[e("div",Ie,[t[18]||(t[18]=e("label",null,"风险等级:",-1)),e("span",{class:V("risk-level "+s.severity)},i(x(s.severity)),3)]),e("div",Ue,[t[19]||(t[19]=e("label",null,"发现时间:",-1)),e("span",null,i(v.value.time),1)])]),s.location?(u(),_("div",xe,[t[20]||(t[20]=e("label",null,"漏洞位置:",-1)),e("pre",null,i(s.location),1)])):f("",!0),s.request?(u(),_("div",Ae,[t[21]||(t[21]=e("label",null,"请求示例:",-1)),e("pre",null,i(s.request),1)])):f("",!0)])],2))),128))])])])):f("",!0)]),_:1},8,["modelValue","title"])])}}},Me=J(He,[["__scopeId","data-v-405e2c6e"]]);export{Me as default};
