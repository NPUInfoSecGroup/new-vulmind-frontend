import{d as I,u as L,o as R,r as _,c as v,b as o,e,G as q,l as d,z as g,A as k,t as i,F as T,k as f,j as u,n as h,m as c,_ as B}from"./index-DCDRhhL_.js";const N={class:"task-manager"},U={class:"task-creator"},z={class:"task-list"},j={class:"status-tabs"},A=["onClick"],E={key:0},G={class:"task-header"},O={class:"status-badge"},Q=["onClick"],X={class:"task-actions"},H=["onClick"],J=["onClick"],K=["onClick"],P=["onClick"],W={key:0,class:"results-container"},Y={class:"severity-tag"},Z={key:1},tt=I({__name:"example",setup(et){const a=L();R(()=>{a.fetchTasks()});const r=_({name:"",target:"",command:""}),m=_("all"),p=v(()=>a.tasks),y=v(()=>m.value==="all"?p.value:p.value.filter(s=>s.status===m.value)),C=v(()=>({all:p.value.length,pending:a.pendingTasks.length,running:a.runningTasks.length,completed:a.completedTasks.length,failed:a.failedTasks.length})),b=s=>new Date(s).toLocaleString(),w=async()=>{await a.fetchTasks()},S=async()=>{await a.addTask({...r.value,status:"pending"}),r.value={name:"",target:"",command:""}},x=async s=>{await a.updateTask(s,{status:"running",startTime:new Date().toISOString()})},$=async s=>{await a.updateTask(s,{status:"completed"})},M=async s=>{await a.updateTask(s,{status:"failed"})},D=async s=>{confirm("确定要删除此任务吗？")&&await a.removeTask(s)},V=s=>{const n=["low","medium","high","critical"],t=["SQL 注入","XSS 跨站脚本","CSRF 跨站请求伪造","命令注入","路径遍历","SSRF 服务端请求伪造"],l=Math.floor(Math.random()*t.length);a.addResult(s,{resultId:`result-${Date.now()}`,severity:n[Math.floor(Math.random()*n.length)],vulnType:t[l],details:`在 ${new Date().toLocaleTimeString()} 检测到 ${t[l]} 漏洞`})};return(s,n)=>(u(),o("div",N,[e("div",U,[n[7]||(n[7]=e("h2",null,"创建新扫描任务",-1)),e("form",{onSubmit:q(S,["prevent"])},[e("label",null,[n[3]||(n[3]=d(" 任务名称: ")),g(e("input",{"onUpdate:modelValue":n[0]||(n[0]=t=>r.value.name=t),required:""},null,512),[[k,r.value.name]])]),e("label",null,[n[4]||(n[4]=d(" 扫描目标: ")),g(e("input",{"onUpdate:modelValue":n[1]||(n[1]=t=>r.value.target=t),placeholder:"https://example.com",required:""},null,512),[[k,r.value.target]])]),e("label",null,[n[5]||(n[5]=d(" 扫描命令: ")),g(e("input",{"onUpdate:modelValue":n[2]||(n[2]=t=>r.value.command=t),placeholder:"nmap -sV",required:""},null,512),[[k,r.value.command]])]),n[6]||(n[6]=e("button",{type:"submit"},"开始扫描",-1))],32)]),e("div",z,[e("h2",null,"任务列表 ("+i(p.value.length)+")",1),e("button",{onClick:w},"刷新任务列表"),e("div",j,[(u(),o(T,null,f(["all","pending","running","completed","failed"],t=>e("button",{key:t,onClick:l=>m.value=t,class:h({active:m.value===t})},i(t)+" ("+i(C.value[t])+") ",11,A)),64))]),y.value.length?(u(),o("ul",E,[(u(!0),o(T,null,f(y.value,t=>(u(),o("li",{key:t.id,class:h(t.status)},[e("div",G,[e("h3",null,i(t.name),1),e("span",O,i(t.status),1),e("button",{onClick:l=>D(t.id)},"删除",8,Q)]),e("p",null,[n[8]||(n[8]=e("strong",null,"目标:",-1)),d(" "+i(t.target),1)]),e("p",null,[n[9]||(n[9]=e("strong",null,"命令:",-1)),d(" "+i(t.command),1)]),e("p",null,[n[10]||(n[10]=e("strong",null,"开始时间:",-1)),d(" "+i(b(t.startTime)),1)]),e("div",X,[t.status==="pending"?(u(),o("button",{key:0,onClick:l=>x(t.id)},"开始扫描",8,H)):c("",!0),t.status==="running"?(u(),o("button",{key:1,onClick:l=>V(t.id)}," 模拟添加结果 ",8,J)):c("",!0),t.status==="running"?(u(),o("button",{key:2,onClick:l=>$(t.id)}," 标记完成 ",8,K)):c("",!0),t.status!=="failed"?(u(),o("button",{key:3,onClick:l=>M(t.id)},"标记失败",8,P)):c("",!0)]),t.results.length?(u(),o("div",W,[e("h4",null,"扫描结果 ("+i(t.results.length)+")",1),(u(!0),o(T,null,f(t.results,(l,F)=>(u(),o("div",{key:l.resultId,class:h(["result-item",l.severity])},[e("p",null,[e("strong",null,"#"+i(F+1)+" "+i(l.vulnType),1)]),e("p",null,[n[11]||(n[11]=d(" 严重程度: ")),e("span",Y,i(l.severity),1)]),e("p",null,i(l.details),1)],2))),128))])):c("",!0)],2))),128))])):(u(),o("p",Z,"没有找到任务"))])]))}}),st=B(tt,[["__scopeId","data-v-9607dc92"]]);export{st as default};
