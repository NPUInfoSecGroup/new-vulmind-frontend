import{m as v,p as T,r as x,b as l,d as o,t as d,q as O,f as i,g as p,w as m,i as u,k as _,_ as g,n as f,l as y,F as S,j as L}from"./index-CGL_rpA9.js";import w from"./MessageView-SUmO-gmt.js";const C={class:"header-section"},I={class:"header-content"},N={class:"id"},V={class:"back-button"},B=v({__name:"TaskInfoView",setup(s){const c=T().params.taskID,a=x("1123");return(r,n)=>{const e=p("el-button");return u(),l("div",C,[o("div",I,[o("h1",null,d(a.value),1),o("p",N,d(O(c)),1)]),o("div",V,[i(e,{type:"primary",onClick:n[0]||(n[0]=h=>r.$router.back())},{default:m(()=>n[1]||(n[1]=[_("返回")])),_:1,__:[1]})])])}}}),P=g(B,[["__scopeId","data-v-c6510808"]]),$={name:"ScanOutput",data(){return{outputLines:[],startTime:new Date().toLocaleTimeString(),autoScroll:!0,isLoading:!0,status:"running",activeTools:["SQLMap","dirsearch","fscan"],scrollPosition:0}},computed:{statusText(){return this.status==="ready"?"就绪，等待扫描开始":"扫描进行中…"},statusClass(){return this.status==="ready"?"ready":"running"}},methods:{addOutputLine(s,t,c){this.outputLines.push({type:s,content:t,tool:c,timestamp:new Date().toLocaleTimeString()}),this.autoScroll&&this.$nextTick(()=>{this.scrollToBottom()})},addCommand(s){this.addOutputLine("command",s)},addResponse(s){this.addOutputLine("response",s)},addSuccess(s){this.addOutputLine("success",s)},addError(s){this.addOutputLine("error",s)},addToolOutput(s,t){this.addOutputLine("tool-output",t,s)},scrollToBottom(){const s=this.$refs.outputContainer;s.scrollTop=s.scrollHeight},clearOutput(){this.outputLines=[],this.startTime=new Date().toLocaleTimeString(),this.addOutputLine("info","输出已清空")},toggleAutoScroll(){this.autoScroll=!this.autoScroll,this.autoScroll&&this.scrollToBottom()},copyOutput(){const s=this.outputLines.map(t=>(t.tool?`[${t.tool}] `:"")+t.content).join(`
`);navigator.clipboard.writeText(s).then(()=>{this.addOutputLine("success","输出已复制到剪贴板")}).catch(t=>{this.addOutputLine("error","复制失败: "+t.message)})},handleScroll(){const s=this.$refs.outputContainer;s.scrollHeight-s.scrollTop===s.clientHeight?this.autoScroll=!0:this.autoScroll=!1},simulateScanOutput(){const s=[{type:"command",text:"scan --target https://example.com"},{type:"info",text:"Starting vulnerability scan..."},{type:"tool-output",text:"Initializing SQLMap v1.6",tool:"SQLMap"},{type:"tool-output",text:"Target URL: https://example.com/login.php",tool:"SQLMap"},{type:"tool-output",text:"Payload: 1 AND 1=1 UNION ALL SELECT 1,NULL...",tool:"SQLMap"},{type:"success",text:"SQLMap: Potential SQL injection detected"},{type:"tool-output",text:"Launching directory brute-force with dirsearch",tool:"dirsearch"},{type:"tool-output",text:"Status 200: /admin",tool:"dirsearch"},{type:"tool-output",text:"Status 200: /backup",tool:"dirsearch"},{type:"tool-output",text:"Status 403: /wp-admin",tool:"dirsearch"},{type:"tool-output",text:"Running network scan with fscan",tool:"fscan"},{type:"tool-output",text:"Port 80/tcp open  http",tool:"fscan"},{type:"tool-output",text:"Port 443/tcp open  ssl/http",tool:"fscan"},{type:"tool-output",text:"Port 8080/tcp open  http-proxy",tool:"fscan"},{type:"tool-output",text:"Cloning .git repository with githack",tool:"githack"},{type:"tool-output",text:"Found .git directory at https://example.com/.git/",tool:"githack"},{type:"success",text:"Scan completed - 3 vulnerabilities found"}];let t=0;const c=setInterval(()=>{if(t>=s.length){clearInterval(c),this.isLoading=!1,this.status="ready",this.addOutputLine("success","所有扫描任务已完成");return}const a=s[t];switch(a.type){case"command":this.addCommand(a.text);break;case"info":this.addOutputLine("info",a.text);break;case"success":this.addSuccess(a.text);break;case"tool-output":this.addToolOutput(a.tool,a.text);break}t++},400)}},mounted(){this.simulateScanOutput()}},A={class:"scan-output card"},D={class:"card-header"},M={class:"header-controls"},Q=["title"],E={class:"card-body"},R={class:"output-timestamp"},j={key:0,class:"tool-tag"},F={key:1,class:"command-prompt"},H={key:0,class:"loading-indicator"},U={class:"card-footer"},z={class:"status-indicator"},q={class:"status-text"},G={class:"tool-usage"};function J(s,t,c,a,r,n){return u(),l("div",A,[o("div",D,[t[6]||(t[6]=o("i",{class:"fas fa-terminal"},null,-1)),t[7]||(t[7]=o("h2",null,"扫描命令输出",-1)),o("div",M,[o("button",{class:"control-btn",onClick:t[0]||(t[0]=(...e)=>n.clearOutput&&n.clearOutput(...e)),title:"清空输出"},t[4]||(t[4]=[o("i",{class:"fas fa-trash"},null,-1)])),o("button",{class:"control-btn",onClick:t[1]||(t[1]=(...e)=>n.toggleAutoScroll&&n.toggleAutoScroll(...e)),title:r.autoScroll?"停止自动滚动":"启用自动滚动"},[o("i",{class:f(["fas",r.autoScroll?"fa-pause":"fa-play"])},null,2)],8,Q),o("button",{class:"control-btn",onClick:t[2]||(t[2]=(...e)=>n.copyOutput&&n.copyOutput(...e)),title:"复制输出"},t[5]||(t[5]=[o("i",{class:"fas fa-copy"},null,-1)]))])]),o("div",E,[o("div",{ref:"outputContainer",class:"cli-output",onScroll:t[3]||(t[3]=(...e)=>n.handleScroll&&n.handleScroll(...e))},[o("div",R,"命令回显开始 "+d(r.startTime),1),(u(!0),l(S,null,L(r.outputLines,(e,h)=>(u(),l("div",{key:h,class:f(["output-line",e.type])},[e.tool?(u(),l("span",j,d(e.tool),1)):y("",!0),o("span",{class:f(["line-content",e.type])},d(e.content),3),e.type==="command"?(u(),l("span",F,"$")):y("",!0)],2))),128)),r.isLoading?(u(),l("div",H,t[8]||(t[8]=[o("i",{class:"fas fa-spinner fa-spin"},null,-1),_(" 扫描进行中... ")]))):y("",!0)],544)]),o("div",U,[o("div",z,[o("div",{class:f(["status-bubble",n.statusClass])},null,2),o("div",q,d(n.statusText),1)]),o("div",G,[(u(!0),l(S,null,L(r.activeTools,e=>(u(),l("span",{key:e,class:"tool-chip"},[t[9]||(t[9]=o("i",{class:"fas fa-toolbox"},null,-1)),_(" "+d(e),1)]))),128))])])])}const K=g($,[["render",J],["__scopeId","data-v-4ea18b34"]]),W={class:"common-layout"},X={class:"message-card"},Y={class:"header-title"},Z={class:"action"},tt={class:"terminal"},ot=v({__name:"EnvironmentInfoView",setup(s){const t=x({name:"任务1",type:"interactive",status:"completed",target:"http://example.com",created_at:"2023-10-01 12:00:00"});return(c,a)=>{const r=p("el-tag"),n=p("el-button"),e=p("el-scrollbar"),h=p("el-aside"),b=p("el-main"),k=p("el-container");return u(),l("div",W,[i(k,null,{default:m(()=>[i(h,{width:"50%",class:"aside"},{default:m(()=>[a[2]||(a[2]=o("h2",null,"环境信息",-1)),o("div",X,[o("div",Y,[o("p",null,d(t.value.target),1),i(r,{effect:"light",type:"info",round:""},{default:m(()=>[_(d(t.value.type),1)]),_:1})]),o("div",Z,[i(n,{type:"primary",onClick:a[0]||(a[0]=()=>{})},{default:m(()=>a[1]||(a[1]=[_(" 执行任务 ")])),_:1,__:[1]})])]),i(e,null,{default:m(()=>[o("div",tt,[i(K)])]),_:1})]),_:1,__:[2]}),i(b,null,{default:m(()=>[a[3]||(a[3]=o("h2",null,"扫描过程",-1)),i(w)]),_:1,__:[3]})]),_:1})])}}}),st=g(ot,[["__scopeId","data-v-78c88762"]]),et={class:"report-template-view"},at=v({__name:"ScannerPage",setup(s){return x("first"),(t,c)=>(u(),l("div",et,[i(P),i(st)]))}}),it=g(at,[["__scopeId","data-v-1a0f5315"]]);export{it as default};
