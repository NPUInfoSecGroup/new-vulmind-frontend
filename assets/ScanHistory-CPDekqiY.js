const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-BQPEXbjb.js","assets/index-CaGyiuhf.css"])))=>i.map(i=>d[i]);
import{_ as N,c as u,a as B,b as e,d as n,w as o,r,e as b,o as I,f as M,g as P,h as H,E as F,i as v,j as m,t as i,n as T,k as p,l as O,F as Y,m as q}from"./index-BQPEXbjb.js";const A={setup(){const w=b([]),t=b(!0),x=async()=>{try{t.value=!0;const s=Object.assign({"/src/scan-details/scan-2023091401.json":()=>H(()=>import("./index-BQPEXbjb.js").then(c=>c.z),__vite__mapDeps([0,1])),"/src/scan-details/scan-2023091501.json":()=>H(()=>import("./index-BQPEXbjb.js").then(c=>c.A),__vite__mapDeps([0,1]))}),k=await Promise.all(Object.keys(s).map(async c=>{const d=await s[c]();return d.default||d}));w.value=k.filter(Boolean).sort((c,d)=>d.id.localeCompare(c.id))}catch(s){console.error("加载扫描记录失败:",s),F.error("加载扫描记录失败: "+s.message)}finally{t.value=!1}};I(()=>{x()});const l=M({target:"",dateRange:[],status:""}),f=b(1),S=b(5),V=P(()=>w.value.length),g=P(()=>w.value.filter(s=>{const k=l.target?s.target.toLowerCase().includes(l.target.toLowerCase()):!0,c=l.dateRange.length===2?s.date>=l.dateRange[0]&&s.date<=l.dateRange[1]:!0,d=l.status?s.status===l.status:!0;return k&&c&&d}).slice((f.value-1)*S.value,f.value*S.value)),R=()=>{f.value=1},y=()=>{l.target="",l.dateRange=[],l.status="",f.value=1},L=s=>{f.value=s},_=b(!1),C=b(null);return{filterForm:l,filteredHistory:g,totalItems:V,pageSize:S,currentPage:f,searchHistory:R,resetFilter:y,handlePageChange:L,viewTechnicalDetails:s=>{C.value={...s},_.value=!0},generateReport:s=>{F.success(`正在生成 ${s.target} 的扫描报告...`)},handleRowClick:s=>{console.log("点击行:",s.id)},detailDialogVisible:_,currentScan:C,getSeverityTagType:s=>{switch(s){case"critical":return"danger";case"high":return"warning";case"medium":return"primary";case"low":return"success";default:return"info"}},getSeverityLabel:s=>{switch(s){case"critical":return"严重";case"high":return"高危";case"medium":return"中危";case"low":return"低危";default:return"未知"}},getSeverityLevel:s=>{switch(s){case"critical":return"极高风险";case"high":return"高风险";case"medium":return"中等风险";case"low":return"低风险";default:return"未知风险"}},loading:t,exportVulnerability:s=>{const k=new Blob([JSON.stringify(s,null,2)],{type:"application/json"}),c=URL.createObjectURL(k),d=document.createElement("a");d.href=c,d.download=`${s.id}.json`,d.click(),URL.revokeObjectURL(c),F.success(`${s.id} 已导出`)}}}},J={class:"scan-history-view"},W={class:"filter-card"},G={class:"filter-section"},K={class:"filter-row"},Q={class:"filter-row"},X={class:"history-card"},Z={class:"history-list"},$={class:"date-container"},ee={class:"date-value"},te={class:"time-value"},ae={class:"target-container"},le={class:"vuln-summary"},se={key:0,class:"vuln-item critical"},ne={class:"vuln-count"},oe={key:1,class:"vuln-item high"},ie={class:"vuln-count"},re={key:2,class:"vuln-item medium"},ce={class:"vuln-count"},de={key:3,class:"vuln-item low"},ue={class:"vuln-count"},ve={class:"action-buttons"},_e={class:"pagination-section"},me={key:0,class:"tech-detail-container"},fe={class:"vulnerability-section"},pe={class:"section-title"},ge={class:"vuln-count"},ye={class:"vuln-list"},he={class:"vuln-header"},be={class:"vuln-title"},ke={class:"vuln-id"},we={class:"vuln-name"},Se={class:"vuln-actions"},Ce={class:"vuln-content"},Ve={class:"vuln-description"},Re={class:"vuln-info-grid"},Le={class:"info-item"},De={class:"info-item"},Fe={key:0,class:"vuln-location"},Te={key:1,class:"vuln-request"},xe={class:"dialog-footer"};function je(w,t,x,l,f,S){const V=r("el-input"),g=r("el-form-item"),R=r("el-date-picker"),y=r("el-option"),L=r("el-select"),_=r("el-button"),C=r("el-form"),h=r("el-table-column"),D=r("el-tag"),j=r("el-table"),z=r("el-pagination"),U=r("el-tooltip"),E=r("el-dialog");return v(),u("div",J,[t[24]||(t[24]=B('<div class="header-section" data-v-f360775a><div class="header-content" data-v-f360775a><div class="title-container" data-v-f360775a><i class="fas fa-history" data-v-f360775a></i><h1 data-v-f360775a>扫描历史记录</h1></div><p class="subtitle" data-v-f360775a>查看和管理扫描历史记录，分析漏洞技术细节</p></div><div class="header-decoration" data-v-f360775a><div class="decoration-item" data-v-f360775a></div><div class="decoration-item" data-v-f360775a></div><div class="decoration-item" data-v-f360775a></div></div></div>',1)),e("div",W,[e("div",G,[n(C,{inline:!0,model:l.filterForm},{default:o(()=>[e("div",K,[n(g,{label:"扫描目标"},{default:o(()=>[n(V,{modelValue:l.filterForm.target,"onUpdate:modelValue":t[0]||(t[0]=a=>l.filterForm.target=a),placeholder:"输入URL或关键词",class:"filter-input"},{prefix:o(()=>t[5]||(t[5]=[e("i",{class:"fas fa-bullseye"},null,-1)])),_:1},8,["modelValue"])]),_:1}),n(g,{label:"日期范围"},{default:o(()=>[n(R,{modelValue:l.filterForm.dateRange,"onUpdate:modelValue":t[1]||(t[1]=a=>l.filterForm.dateRange=a),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"YYYY-MM-DD",class:"filter-date-picker"},{prefix:o(()=>t[6]||(t[6]=[e("i",{class:"fas fa-calendar"},null,-1)])),_:1},8,["modelValue"])]),_:1})]),e("div",Q,[n(g,{label:"状态"},{default:o(()=>[n(L,{modelValue:l.filterForm.status,"onUpdate:modelValue":t[2]||(t[2]=a=>l.filterForm.status=a),placeholder:"选择状态",class:"filter-select"},{default:o(()=>[n(y,{label:"全部",value:""}),n(y,{label:"已完成",value:"completed"}),n(y,{label:"失败",value:"failed"}),n(y,{label:"进行中",value:"scanning"})]),_:1},8,["modelValue"])]),_:1}),n(g,null,{default:o(()=>[n(_,{type:"primary",onClick:l.searchHistory,class:"filter-button primary"},{default:o(()=>t[7]||(t[7]=[e("i",{class:"fas fa-search"},null,-1),m(" 搜索 ")])),_:1,__:[7]},8,["onClick"]),n(_,{onClick:l.resetFilter,class:"filter-button secondary"},{default:o(()=>t[8]||(t[8]=[e("i",{class:"fas fa-undo"},null,-1),m(" 重置 ")])),_:1,__:[8]},8,["onClick"])]),_:1})])]),_:1},8,["model"])])]),e("div",X,[e("div",Z,[n(j,{data:l.filteredHistory,style:{width:"100%"},class:"scan-history-table","row-class-name":"scan-row","header-row-class-name":"header-row",onRowClick:l.handleRowClick},{default:o(()=>[n(h,{prop:"date",label:"扫描日期",width:"180"},{default:o(({row:a})=>[e("div",$,[e("div",ee,i(a.date),1),e("div",te,i(a.time),1)])]),_:1}),n(h,{prop:"target",label:"扫描目标"},{default:o(({row:a})=>[e("div",ae,[e("i",{class:T(["fas",a.type==="web"?"fa-globe":"fa-file-code"])},null,2),e("span",null,i(a.target),1)])]),_:1}),n(h,{prop:"type",label:"扫描类型",width:"120"},{default:o(({row:a})=>[n(D,{type:a.type==="web"?"success":"info",class:"scan-type-tag",effect:"dark",round:""},{default:o(()=>[m(i(a.type==="web"?"Web扫描":"二进制扫描"),1)]),_:2},1032,["type"])]),_:1}),n(h,{label:"结果概要",width:"180"},{default:o(({row:a})=>[e("div",le,[a.vulnSummary.critical>0?(v(),u("div",se,[e("span",ne,i(a.vulnSummary.critical),1),t[9]||(t[9]=e("span",{class:"vuln-label"},"严重",-1))])):p("",!0),a.vulnSummary.high>0?(v(),u("div",oe,[e("span",ie,i(a.vulnSummary.high),1),t[10]||(t[10]=e("span",{class:"vuln-label"},"高危",-1))])):p("",!0),a.vulnSummary.medium>0?(v(),u("div",re,[e("span",ce,i(a.vulnSummary.medium),1),t[11]||(t[11]=e("span",{class:"vuln-label"},"中危",-1))])):p("",!0),a.vulnSummary.low>0?(v(),u("div",de,[e("span",ue,i(a.vulnSummary.low),1),t[12]||(t[12]=e("span",{class:"vuln-label"},"低危",-1))])):p("",!0)])]),_:1}),n(h,{label:"操作",width:"240",fixed:"right"},{default:o(({row:a})=>[e("div",ve,[n(_,{size:"small",class:"action-button tech-details",onClick:O(s=>l.viewTechnicalDetails(a),["stop"])},{default:o(()=>t[13]||(t[13]=[e("i",{class:"fas fa-search"},null,-1),m(" 技术细节 ")])),_:2,__:[13]},1032,["onClick"]),n(_,{size:"small",type:"primary",class:"action-button generate-report",onClick:O(s=>l.generateReport(a),["stop"])},{default:o(()=>t[14]||(t[14]=[e("i",{class:"fas fa-file-pdf"},null,-1),m(" 生成报告 ")])),_:2,__:[14]},1032,["onClick"])])]),_:1})]),_:1},8,["data","onRowClick"]),e("div",_e,[n(z,{background:"",layout:"prev, pager, next, jumper",total:l.totalItems,"page-size":l.pageSize,"current-page":l.currentPage,onCurrentChange:l.handlePageChange,class:"history-pagination"},null,8,["total","page-size","current-page","onCurrentChange"])])])]),n(E,{modelValue:l.detailDialogVisible,"onUpdate:modelValue":t[4]||(t[4]=a=>l.detailDialogVisible=a),title:`扫描技术细节 - ${l.currentScan?l.currentScan.target:""}`,width:"85%",top:"5vh","custom-class":"tech-detail-dialog"},{footer:o(()=>[e("div",xe,[n(_,{onClick:t[3]||(t[3]=a=>l.detailDialogVisible=!1)},{default:o(()=>t[23]||(t[23]=[m("关闭")])),_:1,__:[23]})])]),default:o(()=>[l.currentScan?(v(),u("div",me,[e("div",fe,[e("h3",pe,[t[15]||(t[15]=e("i",{class:"fas fa-bug"},null,-1)),t[16]||(t[16]=m(" 漏洞列表 ")),e("span",ge,"(共 "+i(l.currentScan.vulnerabilities.length)+" 个漏洞)",1)]),e("div",ye,[(v(!0),u(Y,null,q(l.currentScan.vulnerabilities,a=>(v(),u("div",{key:a.id,class:T(["vuln-item",a.severity])},[e("div",he,[e("div",be,[e("span",ke,i(a.id),1),e("span",we,i(a.name),1),n(D,{type:l.getSeverityTagType(a.severity),size:"small",effect:"dark",class:"severity-tag"},{default:o(()=>[m(i(l.getSeverityLabel(a.severity)),1)]),_:2},1032,["type"])]),e("div",Se,[n(U,{effect:"dark",content:"导出详情",placement:"top"},{default:o(()=>[n(_,{circle:"",size:"small",onClick:s=>l.exportVulnerability(a)},{default:o(()=>t[17]||(t[17]=[e("i",{class:"fas fa-download"},null,-1)])),_:2,__:[17]},1032,["onClick"])]),_:2},1024)])]),e("div",Ce,[e("div",Ve,[t[18]||(t[18]=e("label",null,"详细描述:",-1)),e("p",null,i(a.description),1)]),e("div",Re,[e("div",Le,[t[19]||(t[19]=e("label",null,"风险等级:",-1)),e("span",{class:T("risk-level "+a.severity)},i(l.getSeverityLevel(a.severity)),3)]),e("div",De,[t[20]||(t[20]=e("label",null,"发现时间:",-1)),e("span",null,i(l.currentScan.time),1)])]),a.location?(v(),u("div",Fe,[t[21]||(t[21]=e("label",null,"漏洞位置:",-1)),e("pre",null,i(a.location),1)])):p("",!0),a.request?(v(),u("div",Te,[t[22]||(t[22]=e("label",null,"请求示例:",-1)),e("pre",null,i(a.request),1)])):p("",!0)])],2))),128))])])])):p("",!0)]),_:1},8,["modelValue","title"])])}const Ue=N(A,[["render",je],["__scopeId","data-v-f360775a"]]);export{Ue as default};
