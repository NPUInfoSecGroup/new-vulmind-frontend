const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-CnwgvAce.js","assets/index-CN2e-F1k.css"])))=>i.map(i=>d[i]);
import{_ as J,r as b,o as G,a as K,c as W,b as _,d as Q,e as t,f as n,w as o,g as r,h as p,E as L,u as X,i as u,j as v,F as C,k as j,l as Z,t as i,n as V,m as f}from"./index-CnwgvAce.js";const ee={class:"scan-history-view"},te={class:"filter-card"},se={class:"filter-section"},ae={class:"filter-row"},le={class:"filter-row"},ne={class:"scanner-header"},oe={class:"name"},ie={class:"date-info"},de={class:"date"},ce={class:"card-body"},re={class:"target-info"},ue={class:"target"},_e={class:"vuln-summary"},ve={key:0,class:"vuln-item critical"},me={class:"vuln-count"},pe={key:1,class:"vuln-item high"},fe={class:"vuln-count"},ye={key:2,class:"vuln-item medium"},ge={class:"vuln-count"},be={key:3,class:"vuln-item low"},he={class:"vuln-count"},ke={class:"card-footer action-buttons"},Ve={key:0,class:"tech-detail-container"},Re={class:"vulnerability-section"},Se={class:"section-title"},Ee={class:"vuln-count"},Le={class:"vuln-list"},Ce={class:"vuln-header"},je={class:"vuln-title"},we={class:"vuln-id"},De={class:"vuln-name"},Oe={class:"vuln-actions"},Te={class:"vuln-content"},Pe={class:"vuln-description"},Ie={class:"vuln-info-grid"},Ue={class:"info-item"},xe={class:"info-item"},Ae={key:0,class:"vuln-location"},He={key:1,class:"vuln-request"},$e={class:"dialog-footer"},Be={__name:"ScanHistory",setup(Ne){const w=X(),R=b([]),S=b(!0),D=async()=>{try{S.value=!0;const a=Object.assign({"/src/scan-details/scan-2023091401.json":()=>p(()=>import("./index-CnwgvAce.js").then(l=>l.C),__vite__mapDeps([0,1])),"/src/scan-details/scan-2023091501 copy 2.json":()=>p(()=>import("./index-CnwgvAce.js").then(l=>l.D),__vite__mapDeps([0,1])),"/src/scan-details/scan-2023091501 copy 3.json":()=>p(()=>import("./index-CnwgvAce.js").then(l=>l.G),__vite__mapDeps([0,1])),"/src/scan-details/scan-2023091501 copy 4.json":()=>p(()=>import("./index-CnwgvAce.js").then(l=>l.H),__vite__mapDeps([0,1])),"/src/scan-details/scan-2023091501 copy 5.json":()=>p(()=>import("./index-CnwgvAce.js").then(l=>l.I),__vite__mapDeps([0,1])),"/src/scan-details/scan-2023091501 copy.json":()=>p(()=>import("./index-CnwgvAce.js").then(l=>l.J),__vite__mapDeps([0,1])),"/src/scan-details/scan-2023091501.json":()=>p(()=>import("./index-CnwgvAce.js").then(l=>l.K),__vite__mapDeps([0,1]))}),e=await Promise.all(Object.keys(a).map(async l=>{const c=await a[l]();return c.default||c}));R.value=e.filter(Boolean).sort((l,c)=>c.id.localeCompare(l.id))}catch(a){console.error("加载扫描记录失败:",a),L.error("加载扫描记录失败: "+a.message)}finally{S.value=!1}};G(()=>{D()});const d=K({target:"",dateRange:[],status:""}),O=W(()=>R.value.filter(a=>{const e=d.target?a.target.toLowerCase().includes(d.target.toLowerCase()):!0,l=d.dateRange.length===2?a.date>=d.dateRange[0]&&a.date<=d.dateRange[1]:!0,c=d.status?a.status===d.status:!0;return e&&l&&c})),T=()=>{currentPage.value=1},P=()=>{d.target="",d.dateRange=[],d.status="",currentPage.value=1},h=b(!1),m=b(null),I=a=>{switch(a){case"critical":return"danger";case"high":return"warning";case"medium":return"primary";case"low":return"success";default:return"info"}},U=a=>{switch(a){case"critical":return"严重";case"high":return"高危";case"medium":return"中危";case"low":return"低危";default:return"未知"}},x=a=>{switch(a){case"critical":return"极高风险";case"high":return"高风险";case"medium":return"中等风险";case"low":return"低风险";default:return"未知风险"}},A=a=>{m.value={...a},w.push("/scan-history/"+a.id)},H=a=>{const e=new Blob([JSON.stringify(a,null,2)],{type:"application/json"}),l=URL.createObjectURL(e),c=document.createElement("a");c.href=l,c.download=`${a.id}.json`,c.click(),URL.revokeObjectURL(l),L.success(`${a.id} 已导出`)};return(a,e)=>{const l=r("el-input"),c=r("el-form-item"),$=r("el-date-picker"),g=r("el-option"),B=r("el-select"),y=r("el-button"),N=r("el-form"),E=r("el-tag"),F=r("el-card"),M=r("el-col"),Y=r("el-row"),q=r("el-tooltip"),z=r("el-dialog");return u(),_("div",ee,[e[23]||(e[23]=Q('<div class="header-section" data-v-d6b113f0><div class="header-content" data-v-d6b113f0><div class="title-container" data-v-d6b113f0><i class="fas fa-history" data-v-d6b113f0></i><h1 data-v-d6b113f0>扫描历史记录</h1></div><p class="subtitle" data-v-d6b113f0>查看和管理扫描历史记录，分析漏洞技术细节</p></div><div class="header-decoration" data-v-d6b113f0><div class="decoration-item" data-v-d6b113f0></div><div class="decoration-item" data-v-d6b113f0></div><div class="decoration-item" data-v-d6b113f0></div></div></div>',1)),t("div",te,[t("div",se,[n(N,{inline:!0,model:d},{default:o(()=>[t("div",ae,[n(c,{label:"扫描目标"},{default:o(()=>[n(l,{modelValue:d.target,"onUpdate:modelValue":e[0]||(e[0]=s=>d.target=s),placeholder:"输入URL或关键词",class:"filter-input"},{prefix:o(()=>e[5]||(e[5]=[t("i",{class:"fas fa-bullseye"},null,-1)])),_:1},8,["modelValue"])]),_:1}),n(c,{label:"日期范围"},{default:o(()=>[n($,{modelValue:d.dateRange,"onUpdate:modelValue":e[1]||(e[1]=s=>d.dateRange=s),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"YYYY-MM-DD",class:"filter-date-picker"},{prefix:o(()=>e[6]||(e[6]=[t("i",{class:"fas fa-calendar"},null,-1)])),_:1},8,["modelValue"])]),_:1})]),t("div",le,[n(c,{label:"状态"},{default:o(()=>[n(B,{modelValue:d.status,"onUpdate:modelValue":e[2]||(e[2]=s=>d.status=s),placeholder:"选择状态",class:"filter-select"},{default:o(()=>[n(g,{label:"全部",value:""}),n(g,{label:"已完成",value:"completed"}),n(g,{label:"失败",value:"failed"}),n(g,{label:"进行中",value:"scanning"})]),_:1},8,["modelValue"])]),_:1}),n(c,null,{default:o(()=>[n(y,{type:"primary",onClick:T,class:"filter-button primary"},{default:o(()=>e[7]||(e[7]=[t("i",{class:"fas fa-search"},null,-1),v(" 搜索 ")])),_:1,__:[7]}),n(y,{onClick:P,class:"filter-button secondary"},{default:o(()=>e[8]||(e[8]=[t("i",{class:"fas fa-undo"},null,-1),v(" 重置 ")])),_:1,__:[8]})]),_:1})])]),_:1},8,["model"])])]),n(Y,{gutter:20,class:"scan-history-cards"},{default:o(()=>[(u(!0),_(C,null,j(O.value,(s,k)=>(u(),Z(M,{key:k,xs:24,sm:12,md:8,lg:6},{default:o(()=>[n(F,{class:"scan-history-card",shadow:"hover"},{default:o(()=>[t("div",ne,[t("div",oe,[v(i(s.name||`扫描记录 ${k+1}`)+" ",1),n(E,{type:s.type==="web"?"success":"info",class:"scan-type-tag",effect:"dark"},{default:o(()=>[v(i(s.type==="web"?"Web扫描":"二进制扫描"),1)]),_:2},1032,["type"])]),t("div",ie,[t("div",de,i(s.date)+" "+i(s.time),1)])]),t("div",ce,[t("div",re,[t("i",{class:V(["fas",s.type==="web"?"fa-globe":"fa-file-code"])},null,2),t("span",ue,i(s.target),1)]),t("div",_e,[s.vulnSummary.critical>0?(u(),_("div",ve,[e[9]||(e[9]=t("span",{class:"vuln-label"},"严重",-1)),t("span",me,i(s.vulnSummary.critical),1)])):f("",!0),s.vulnSummary.high>0?(u(),_("div",pe,[e[10]||(e[10]=t("span",{class:"vuln-label"},"高危",-1)),t("span",fe,i(s.vulnSummary.high),1)])):f("",!0),s.vulnSummary.medium>0?(u(),_("div",ye,[e[11]||(e[11]=t("span",{class:"vuln-label"},"中危",-1)),t("span",ge,i(s.vulnSummary.medium),1)])):f("",!0),s.vulnSummary.low>0?(u(),_("div",be,[e[12]||(e[12]=t("span",{class:"vuln-label"},"低危",-1)),t("span",he,i(s.vulnSummary.low),1)])):f("",!0)])]),t("div",ke,[n(y,{type:"primary",onClick:Fe=>A(s)},{default:o(()=>e[13]||(e[13]=[t("i",{class:"fas fa-search"},null,-1),v(" 查看详情 ")])),_:2,__:[13]},1032,["onClick"])])]),_:2},1024)]),_:2},1024))),128))]),_:1}),n(z,{modelValue:h.value,"onUpdate:modelValue":e[4]||(e[4]=s=>h.value=s),title:`扫描技术细节 - ${m.value?m.value.target:""}`,width:"85%",top:"5vh","custom-class":"tech-detail-dialog"},{footer:o(()=>[t("div",$e,[n(y,{onClick:e[3]||(e[3]=s=>h.value=!1)},{default:o(()=>e[22]||(e[22]=[v("关闭")])),_:1,__:[22]})])]),default:o(()=>[m.value?(u(),_("div",Ve,[t("div",Re,[t("h3",Se,[e[14]||(e[14]=t("i",{class:"fas fa-bug"},null,-1)),e[15]||(e[15]=v(" 漏洞列表 ")),t("span",Ee,"(共 "+i(m.value.vulnerabilities.length)+" 个漏洞)",1)]),t("div",Le,[(u(!0),_(C,null,j(m.value.vulnerabilities,s=>(u(),_("div",{key:s.id,class:V(["vuln-item",s.severity])},[t("div",Ce,[t("div",je,[t("span",we,i(s.id),1),t("span",De,i(s.name),1),n(E,{type:I(s.severity),size:"small",effect:"dark",class:"severity-tag"},{default:o(()=>[v(i(U(s.severity)),1)]),_:2},1032,["type"])]),t("div",Oe,[n(q,{effect:"dark",content:"导出详情",placement:"top"},{default:o(()=>[n(y,{circle:"",size:"small",onClick:k=>H(s)},{default:o(()=>e[16]||(e[16]=[t("i",{class:"fas fa-download"},null,-1)])),_:2,__:[16]},1032,["onClick"])]),_:2},1024)])]),t("div",Te,[t("div",Pe,[e[17]||(e[17]=t("label",null,"详细描述:",-1)),t("p",null,i(s.description),1)]),t("div",Ie,[t("div",Ue,[e[18]||(e[18]=t("label",null,"风险等级:",-1)),t("span",{class:V("risk-level "+s.severity)},i(x(s.severity)),3)]),t("div",xe,[e[19]||(e[19]=t("label",null,"发现时间:",-1)),t("span",null,i(m.value.time),1)])]),s.location?(u(),_("div",Ae,[e[20]||(e[20]=t("label",null,"漏洞位置:",-1)),t("pre",null,i(s.location),1)])):f("",!0),s.request?(u(),_("div",He,[e[21]||(e[21]=t("label",null,"请求示例:",-1)),t("pre",null,i(s.request),1)])):f("",!0)])],2))),128))])])])):f("",!0)]),_:1},8,["modelValue","title"])])}}},Ye=J(Be,[["__scopeId","data-v-d6b113f0"]]);export{Ye as default};
