import{_ as D,r as u,c as C,q as P,b as r,e,m as L,F as $,k as B,n as m,t as h,G as E,y as U,z as j,l as f,j as l,B as M}from"./index-mgR_4hwW.js";import{m as k,p as O}from"./purify.es-CsY-PwS5.js";const R={class:"deepseek-container"},H={class:"chat-panel"},K={class:"messages-container"},N={class:"message-header"},V={key:0,class:"fas fa-user"},z={key:1,class:"fas fa-robot"},q=["innerHTML"],F={key:0,class:"typing-container"},G={class:"input-container"},J=["disabled"],Q=["disabled"],W={key:0,class:"fas fa-spinner fa-spin"},X={key:1,class:"fas fa-paper-plane"},Y={class:"control-panel"},Z={class:"status-container"},ee={__name:"ReportParse",setup(te){const _=t=>{if(!t)return"";k.setOptions({gfm:!0,breaks:!0,highlight:(s,n)=>`<pre><code class="hljs language-${n||"plaintext"}">${y(s)}</code></pre>`});const a=k.parse(t);return O.sanitize(a)},y=t=>t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),b=()=>{M(()=>{const t=document.querySelector(".messages-container");t&&(t.scrollTop=t.scrollHeight)})},o=u([{role:"assistant",content:`你好！我是DeepSeek AI助手。请问有什么我可以帮助您的？

- 我可以回答技术问题
- 帮助解决编程难题
- 解释复杂概念
- 提供学习资源建议`}]),i=u(""),c=u(!1),v=u(!1),d=u("connected"),w=C(()=>({connected:"API连接正常",connecting:"正在连接API...",error:"API连接错误"})[d.value]),g=async()=>{if(!i.value.trim()||c.value)return;const t=i.value;i.value="",o.value.push({role:"user",content:t}),c.value=!0,v.value=!0,d.value="connecting";try{const a=await S(t);o.value.push({role:"assistant",content:a}),d.value="connected"}catch(a){console.error("API请求错误:",a),o.value.push({role:"assistant",content:`抱歉，请求出错: ${a.message}`}),d.value="error"}finally{c.value=!1,v.value=!1}},S=async t=>{const n=await fetch("https://api.deepseek.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer sk-cc8300aca20d492f8d4726bf1510bb84"},body:JSON.stringify({model:"deepseek-chat",messages:[...o.value,{role:"user",content:t}],temperature:.7,max_tokens:2e3,stream:!1})});if(!n.ok)throw new Error(`API请求失败: ${n.status}`);return(await n.json()).choices[0].message.content},I=()=>{if(o.value.length===0)return;let t=`# DeepSeek对话记录

`;o.value.forEach(p=>{const T=p.role==="user"?"**您**:":"**DeepSeek AI**:";t+=`${T}

${p.content}

---

`});const a=new Blob([t],{type:"text/markdown"}),s=URL.createObjectURL(a),n=document.createElement("a");n.href=s,n.download=`deepseek-chat-${new Date().toISOString().slice(0,10)}.md`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(s)},x=()=>{o.value=[{role:"assistant",content:"对话已重置！有什么可以帮您的吗？"}]},A=t=>{t.key==="Enter"&&!t.shiftKey&&(t.preventDefault(),g())};return P(o,()=>{b()},{deep:!0,immediate:!0}),(t,a)=>(l(),r("div",R,[a[4]||(a[4]=e("header",{class:"app-header"},[e("div",{class:"header-content"},[e("h1",{class:"app-title"},"DeepSeek API"),e("p",{class:"app-subtitle"},"AI对话助手")])],-1)),e("div",H,[e("div",K,[(l(!0),r($,null,B(o.value,(s,n)=>(l(),r("div",{key:n,class:m(["message",s.role==="user"?"user-message":"ai-message"])},[e("div",N,[e("div",{class:m(["avatar",s.role==="user"?"user-avatar":"ai-avatar"])},[s.role==="user"?(l(),r("i",V)):(l(),r("i",z))],2),e("strong",null,h(s.role==="user"?"您":"DeepSeek AI"),1)]),e("div",{class:"message-content",innerHTML:_(s.content)},null,8,q)],2))),128)),v.value?(l(),r("div",F,a[1]||(a[1]=[E('<div class="typing-indicator" data-v-97cd590a><span class="typing-text" data-v-97cd590a>思考中</span><div class="typing-dots" data-v-97cd590a><div class="dot" data-v-97cd590a></div><div class="dot" data-v-97cd590a></div><div class="dot" data-v-97cd590a></div></div></div>',1)]))):L("",!0)]),e("div",G,[U(e("textarea",{"onUpdate:modelValue":a[0]||(a[0]=s=>i.value=s),placeholder:"输入您的消息（Shift+Enter换行，Enter发送）...",onKeydown:A,disabled:c.value},null,40,J),[[j,i.value]]),e("button",{class:"submit-btn",onClick:g,disabled:c.value||!i.value.trim()},[c.value?(l(),r("i",W)):(l(),r("i",X)),f(" "+h(c.value?"生成中...":"发送"),1)],8,Q)])]),e("div",Y,[e("div",Z,[e("div",{class:m(["status-indicator",d.value==="connecting"?"connecting":d.value==="error"?"error":""])},null,2),e("span",null,h(w.value),1)]),e("div",{class:"action-buttons"},[e("button",{class:"action-btn download-btn",onClick:I},a[2]||(a[2]=[e("i",{class:"fas fa-download"},null,-1),f(" 保存对话 ")])),e("button",{class:"action-btn clear-btn",onClick:x},a[3]||(a[3]=[e("i",{class:"fas fa-trash-alt"},null,-1),f(" 清空对话 ")]))])])]))}},ne=D(ee,[["__scopeId","data-v-97cd590a"]]);export{ne as default};
